



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="http://autokeras.com/nas/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.2">
    
    
      
        <title>Neural Architecture Search - Auto-Keras</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-44322747-3", "autokeras.com")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#neural-architecture-search" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://autokeras.com" title="Auto-Keras" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Auto-Keras
            </span>
            <span class="md-header-nav__topic">
              Neural Architecture Search
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/keras-team/autokeras" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://autokeras.com" title="Auto-Keras" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Auto-Keras
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/keras-team/autokeras" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../start/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../temp/contribute/" title="Contributing Guide" class="md-nav__link">
      Contributing Guide
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Neural Architecture Search
      </label>
    
    <a href="./" title="Neural Architecture Search" class="md-nav__link md-nav__link--active">
      Neural Architecture Search
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-implement-nas-papers-in-auto-keras" title="Why implement NAS papers in Auto-Keras?" class="md-nav__link">
    Why implement NAS papers in Auto-Keras?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#baseline-methods-implemented" title="Baseline methods implemented" class="md-nav__link">
    Baseline methods implemented
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-the-baseline-methods" title="How to run the baseline methods?" class="md-nav__link">
    How to run the baseline methods?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-implement-your-own-search" title="How to implement your own search?" class="md-nav__link">
    How to implement your own search?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/supervised/" title="supervised" class="md-nav__link">
      supervised
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/image_supervised/" title="image_supervised" class="md-nav__link">
      image_supervised
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/bayesian/" title="bayesian" class="md-nav__link">
      bayesian
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/search/" title="search" class="md-nav__link">
      search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/graph/" title="graph" class="md-nav__link">
      graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/preprocessor/" title="preprocessor" class="md-nav__link">
      preprocessor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/model_trainer/" title="model_trainer" class="md-nav__link">
      model_trainer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/utils/" title="utils" class="md-nav__link">
      utils
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../temp/generator/" title="generator" class="md-nav__link">
      generator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-implement-nas-papers-in-auto-keras" title="Why implement NAS papers in Auto-Keras?" class="md-nav__link">
    Why implement NAS papers in Auto-Keras?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#baseline-methods-implemented" title="Baseline methods implemented" class="md-nav__link">
    Baseline methods implemented
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-the-baseline-methods" title="How to run the baseline methods?" class="md-nav__link">
    How to run the baseline methods?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-implement-your-own-search" title="How to implement your own search?" class="md-nav__link">
    How to implement your own search?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="neural-architecture-search">Neural Architecture Search</h1>
<p>To help the researchers to do experiments on neural architecture search (NAS),
we have implemented several baseline methods using the Auto-Keras framework.
The implementations are easy since only the core part of the search algorithm is needed.
All other parts of NAS (e.g. data structures for storing neural architectures, training of the neural networks)
are done by the Auto-Keras framework.</p>
<h2 id="why-implement-nas-papers-in-auto-keras">Why implement NAS papers in Auto-Keras?</h2>
<p>The NAS papers usually evaluate their work with the same dataset (e.g. CIFAR10),
but they are not directly comparable because of the data preparation and training process are different,
the influence of which are significant enough to change the rankings of these NAS methods.</p>
<p>We have implemented some of the NAS methods in the framework.
More state-of-the-art methods are in progress.
There are three advantages of implementing the NAS methods in Auto-Keras.
First, it fairly compares the NAS methods independent from other factors
(e.g. the choice of optimizer, data augmentation).
Second, researchers can easily change the experiment datasets used for NAS.
Many of the currently available NAS implementations couple too much with the dataset used,
which makes it hard to replace the original dataset with a new one.
Third, it saves the effort of finding and running code from different sources.
Different code may have different requirements of dependencies and environments,
which may conflict with each other.</p>
<h2 id="baseline-methods-implemented">Baseline methods implemented</h2>
<p>We have implemented four NAS baseline methods:</p>
<ol>
<li>
<p><a href="https://github.com/datamllab/autokeras-algorithm/blob/master/nas/random.py#L8">random search</a>: we explore the search space via morphing the network architectures randomly, so the actual 
performance of the generated neural architecture has no effect on later search.</p>
</li>
<li>
<p><a href="https://github.com/datamllab/autokeras-algorithm/blob/master/nas/grid.py#L6">grid search</a>:
 we manually specified subset of the hyperparameter space to search, i.e., the number of layers and 
the width of the layers are predefined.</p>
</li>
<li>
<p><a href="https://github.com/datamllab/autokeras-algorithm/blob/master/nas/greedy.py#L48">greed search</a>: we explore the search space in a greedy way. The "greedy" here means the base architecture for the 
next iteration of search is chosen from those generated by current iteration, the one that have best performance on the training/validation set in our implementation.</p>
</li>
<li>
<p><a href="https://github.com/keras-team/autokeras/blob/master/autokeras/search.py#L275">bayesian optimization</a>: it's the default search strategy of Auto-Keras currently. refer <a href="https://arxiv.org/abs/1806.10282">arXiv:1806.10282</a> for more detail. </p>
</li>
</ol>
<h2 id="how-to-run-the-baseline-methods">How to run the baseline methods?</h2>
<p>Refer to <a href="https://github.com/datamllab/autokeras-algorithm/blob/master/examples/cifar10_tutorial.py"><code>examples/nas/cifar10_tutorial.py</code></a> for more details.</p>
<h2 id="how-to-implement-your-own-search">How to implement your own search?</h2>
<p>To implement your own NAS searcher, you need to implement your own searcher class YOUR_SEARCHER, which is derived 
from base <a href="https://github.com/keras-team/autokeras/blob/master/autokeras/search.py"><code>Searcher</code></a> class. For your 
<code>YOUR_SEARCHER</code> class, you must provide implementation of the two abstract method: </p>
<ol>
<li>
<p><a href="https://github.com/keras-team/autokeras/blob/master/autokeras/search.py#L223"><code>generate(self, multiprocessing_queue)</code></a>, 
which is invoked to generate the next neural architecture.
The return value of the generate function should be two elements.
The first one is the generated graph.
The second one is any other information you want to pass to the update function.
If you have multiple values to pass, you need to put them into one tuple.
If you don't have any value to pass, you can just put None.</p>
</li>
<li>
<p><a href="https://github.com/keras-team/autokeras/blob/master/autokeras/search.py#L238"><code>update(self, other_info, model_id, graph, metric_value)</code></a>, which is invoked 
to update the controller with evaluation result of a neural architecture.
The graph and other_info in the parameters are the corresponding return value of the generate function.
There is no required return value for this function.</p>
</li>
</ol>
<p>You can refer to the default <a href="https://github.com/keras-team/autokeras/blob/master/autokeras/search.py#L275"><code>BayesianSearcher</code></a>
as an example.
The <a href="https://github.com/keras-team/autokeras/blob/master/autokeras/search.py#L298"><code>generate</code></a> 
function returns the generated graph and the father ID of the graph in the search tree. Then when the generated model 
finish
training, the father ID 
(<code>other_info</code>) 
and ID (<code>model_id</code>) and instance (<code>graph</code>) and metric value (<code>metric_value</code>) of the model are passed to <a href="https://github.com/keras-team/autokeras/blob/master/autokeras/search.py#L321">update</a> 
function to 
update the controller <code>BayesianOptimizer</code>.</p>
<p>You can find more example <a href="https://github.com/datamllab/autokeras-algorithm/tree/master/nas">here</a>.</p>
<p>You are welcome to implement your own method for NAS in our framework.
If it works well, we are happy to merge it into our repo.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../temp/contribute/" title="Contributing Guide" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Contributing Guide
              </span>
            </div>
          </a>
        
        
          <a href="../temp/supervised/" title="supervised" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                supervised
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.267712eb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>